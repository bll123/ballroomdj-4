section 150 Per-Queue-Controls

# fixed in 4.0.1
test 150-10 Maximum-Play-Time
# use 20 seconds max for queue 0
msg main MUSICQ_SET_PLAYBACK 0
msg main CHK_MAIN_SET_MAXPLAYTIME 20000
# queue 1 has the maximum play time set to 10 seconds
# make sure gap is set to default
msg main MUSICQ_SET_PLAYBACK 1
msg main CHK_MAIN_SET_QUEUE_ACTIVE 1
msg main CHK_MAIN_SET_GAP 2000
msg main CHK_MAIN_SET_MAXPLAYTIME 10000
msg main MUSICQ_SET_PLAYBACK 0
#
msg main QUEUE_PLAYLIST 0~test-sl-a
msg main QUEUE_PLAYLIST 1~test-sl-a
#
msg main MUSICQ_SET_MANAGE 0
get main CHK_MAIN_MUSICQ
chk-gt mq0len 5
chk-gt mq1len 5
#
msg main CMD_PLAY
resptimeout 2000
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
get player CHK_PLAYER_SONG
chk p-duration 20000
msg player PLAY_FADE
resptimeout 7500
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
get player CHK_PLAYER_SONG
chk p-duration 20000
#
msg main MUSICQ_SET_PLAYBACK 1
msg player PLAY_FADE
resptimeout 7500
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
get player CHK_PLAYER_SONG
chk p-duration 10000
#
msg main MUSICQ_SET_MANAGE 1
msg main MUSICQ_SET_PLAYBACK 0
msg player PLAY_FADE
resptimeout 7500
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
get player CHK_PLAYER_SONG
chk p-duration 20000
#
msg main MUSICQ_SET_PLAYBACK 1
msg player PLAY_FADE
resptimeout 7500
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
get player CHK_PLAYER_SONG
chk p-duration 10000
#
msg main MUSICQ_SET_PLAYBACK 0
msg player PLAY_FADE
resptimeout 7500
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
get player CHK_PLAYER_SONG
chk p-duration 20000
msg main MUSICQ_SET_PLAYBACK 1
msg main CHK_MAIN_SET_MAXPLAYTIME 360000
msg main CHK_MAIN_SET_QUEUE_ACTIVE 0
msg main MUSICQ_SET_PLAYBACK 0
msg main CHK_MAIN_SET_MAXPLAYTIME 360000
end


test 150-20 Gap
msg main MUSICQ_SET_PLAYBACK 0
msg main MUSICQ_SET_PLAYBACK 1
msg main CHK_MAIN_SET_QUEUE_ACTIVE 1
msg main CHK_MAIN_SET_GAP 0
msg main MUSICQ_SET_PLAYBACK 0
msg main QUEUE_PLAYLIST 0~test-sl-a
msg main QUEUE_PLAYLIST 1~test-sl-a
msg main CMD_PLAY
#
resptimeout 2000
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
msg player PLAY_FADE
resptimeout 4500
get player CHK_PLAYER_STATUS
# should be a gap
wait playstate in-gap
resptimeout 2500
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
#
msg player PLAY_FADE
resptimeout 4500
get player CHK_PLAYER_STATUS
# should be a gap
wait playstate in-gap
resptimeout 2500
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
#
msg main MUSICQ_SET_PLAYBACK 1
msg player PLAY_FADE
resptimeout 7500
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
msg player PLAY_FADE
resptimeout 4500
get player CHK_PLAYER_STATUS
wait playstate in-fadeout
wait-not playstate in-fadeout
# should not be a gap
chk-or playstate stopped loading playing
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
#
msg player PLAY_FADE
resptimeout 7500
get player CHK_PLAYER_STATUS
wait playstate in-fadeout
wait-not playstate in-fadeout
# should not be a gap
chk-or playstate stopped loading playing
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
#
msg main MUSICQ_SET_MANAGE 1
msg main MUSICQ_SET_PLAYBACK 0
msg player PLAY_FADE
resptimeout 4500
get player CHK_PLAYER_STATUS
# should be a gap
wait playstate in-gap
resptimeout 2500
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
#
msg player PLAY_FADE
resptimeout 4500
get player CHK_PLAYER_STATUS
# should be a gap
wait playstate in-gap
resptimeout 2500
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
#
msg player PLAY_FADE
resptimeout 7500
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
#
msg main MUSICQ_SET_PLAYBACK 1
msg player PLAY_FADE
resptimeout 4500
get player CHK_PLAYER_STATUS
wait playstate in-fadeout
wait-not playstate in-fadeout
# should not be a gap
chk-or playstate stopped loading playing
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
#
msg player PLAY_FADE
resptimeout 7500
get player CHK_PLAYER_STATUS
wait playstate in-fadeout
wait-not playstate in-fadeout
# should not be a gap
chk-or playstate stopped loading playing
wait playstate playing
mssleep 1500
get player CHK_PLAYER_STATUS
chk currvolume defaultvol actualvolume defaultvol
msg main MUSICQ_SET_PLAYBACK 1
msg main CHK_MAIN_SET_GAP 0
msg main CHK_MAIN_SET_QUEUE_ACTIVE 0
msg main MUSICQ_SET_PLAYBACK 0
end


# check playback with no fade-in set
test 150-30 Fade-In
msg player PLAYER_VOLUME 30
msg main MUSICQ_SET_PLAYBACK 0
msg main MUSICQ_SET_PLAYBACK 1
msg main CHK_MAIN_SET_QUEUE_ACTIVE 1
msg main CHK_MAIN_SET_FADEIN 0
msg main MUSICQ_SET_PLAYBACK 0
msg main QUEUE_PLAYLIST 0~test-sl-a
msg main QUEUE_PLAYLIST 1~test-sl-a
msg main CMD_PLAY
#
resptimeout 3000
get player CHK_PLAYER_STATUS
wait playstate playing
chk-lt actualvolume 30
mssleep 1500
get player CHK_PLAYER_STATUS
chk actualvolume 30
#
msg main MUSICQ_SET_PLAYBACK 1
resptimeout 7500
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate playing
chk actualvolume 30
mssleep 1500
get player CHK_PLAYER_STATUS
chk actualvolume 30
#
msg main MUSICQ_SET_PLAYBACK 0
resptimeout 7500
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate playing
chk-lt actualvolume 30
mssleep 1500
get player CHK_PLAYER_STATUS
chk actualvolume 30
#
msg main MUSICQ_SET_MANAGE 1
msg main MUSICQ_SET_PLAYBACK 1
resptimeout 7500
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate playing
chk actualvolume 30
mssleep 1500
get player CHK_PLAYER_STATUS
chk actualvolume 30
#
msg main MUSICQ_SET_PLAYBACK 1
msg main CHK_MAIN_SET_FADEIN 400
msg main CHK_MAIN_SET_QUEUE_ACTIVE 0
msg main MUSICQ_SET_PLAYBACK 0
end


# check playback with no fade-out set
test 150-40 Fade-Out
msg player PLAYER_VOLUME 30
msg main MUSICQ_SET_PLAYBACK 0
msg main MUSICQ_SET_PLAYBACK 1
msg main CHK_MAIN_SET_QUEUE_ACTIVE 1
msg main CHK_MAIN_SET_FADEOUT 0
msg main MUSICQ_SET_PLAYBACK 0
msg main QUEUE_PLAYLIST 0~test-sl-a
msg main QUEUE_PLAYLIST 1~test-sl-a
msg main CMD_PLAY
#
resptimeout 3000
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
#
msg main MUSICQ_SET_PLAYBACK 1
resptimeout 7500
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
# fade-out is active (from queue 0)
wait playstate in-fadeout
wait playstate playing
mssleep 1500
#
msg main MUSICQ_SET_PLAYBACK 0
resptimeout 7500
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
# fade-out is not active (from queue 1)
wait-not playstate in-fadeout
wait playstate playing
mssleep 1500
#
msg main MUSICQ_SET_MANAGE 1
msg main MUSICQ_SET_PLAYBACK 1
resptimeout 7500
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
# fade-out is active (from queue 0)
wait playstate in-fadeout
wait playstate playing
mssleep 1500
#
msg main MUSICQ_SET_PLAYBACK 0
resptimeout 7500
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
# fade-out is not active (from queue 1)
wait-not playstate in-fadeout
wait playstate playing
mssleep 1500
#
msg main MUSICQ_SET_PLAYBACK 1
msg main CHK_MAIN_SET_FADEOUT 0
msg main CHK_MAIN_SET_QUEUE_ACTIVE 0
msg main MUSICQ_SET_PLAYBACK 0
end


# play when queued
test 150-50 Play-When-Queued-Basic
msg main MUSICQ_SET_PLAYBACK 0
msg main MUSICQ_SET_PLAYBACK 1
msg main CHK_MAIN_SET_QUEUE_ACTIVE 1
msg main CHK_MAIN_SET_PLAY_WHEN_QUEUED 1
msg main MUSICQ_SET_PLAYBACK 0
msg main MUSICQ_INSERT 0~999~5
#
resptimeout 2500
get player CHK_PLAYER_STATUS
chk playstate stopped
resptimeout 2500
msg main CMD_PLAY
get player CHK_PLAYER_STATUS
wait playstate playing
#
resptimeout 7500
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate in-fadeout
wait playstate stopped
#
msg main MUSICQ_SET_PLAYBACK 1
msg main MUSICQ_INSERT 1~999~8
mssleep 2500
resptimeout 2500
get player CHK_PLAYER_STATUS
chk playstate playing
#
msg main MUSICQ_SET_PLAYBACK 1
msg main CHK_MAIN_SET_PLAY_WHEN_QUEUED 0
msg main CHK_MAIN_SET_QUEUE_ACTIVE 0
msg main MUSICQ_SET_PLAYBACK 0
end

# pause each song
test 150-60 Pause-Each-Song
msg main MUSICQ_SET_PLAYBACK 0
msg main MUSICQ_SET_PLAYBACK 1
msg main CHK_MAIN_SET_QUEUE_ACTIVE 1
msg main CHK_MAIN_SET_PAUSE_EACH_SONG 1
msg main MUSICQ_SET_PLAYBACK 0
msg main MUSICQ_INSERT 0~999~13
msg main MUSICQ_INSERT 0~999~14
msg main MUSICQ_INSERT 0~999~15
msg main MUSICQ_INSERT 0~999~16
msg main MUSICQ_INSERT 0~999~17
msg main MUSICQ_INSERT 0~999~18
msg main MUSICQ_INSERT 1~999~19
msg main MUSICQ_INSERT 1~999~20
msg main MUSICQ_INSERT 1~999~21
#
resptimeout 2500
msg main CMD_PLAY
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
resptimeout 7500
msg player PLAY_FADE
wait playstate in-fadeout
wait playstate playing
mssleep 1500
#
msg main MUSICQ_SET_PLAYBACK 1
resptimeout 7500
msg player PLAY_FADE
wait playstate in-fadeout
wait playstate playing
mssleep 1500
resptimeout 7500
msg player PLAY_FADE
wait playstate in-fadeout
wait playstate stopped
#
resptimeout 2500
msg main CMD_PLAY
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
resptimeout 7500
msg player PLAY_FADE
wait playstate in-fadeout
wait playstate stopped
#
msg main MUSICQ_SET_PLAYBACK 0
resptimeout 2500
msg main CMD_PLAY
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1500
resptimeout 7500
msg player PLAY_FADE
wait playstate in-fadeout
wait playstate playing
mssleep 1500
#
msg main MUSICQ_SET_PLAYBACK 1
resptimeout 7500
msg player PLAY_FADE
wait playstate in-fadeout
wait playstate playing
mssleep 1500
resptimeout 7500
msg player PLAY_FADE
wait playstate in-fadeout
wait playstate stopped
#
msg main MUSICQ_SET_PLAYBACK 1
msg main CHK_MAIN_SET_PAUSE_EACH_SONG 0
msg main CHK_MAIN_SET_QUEUE_ACTIVE 0
msg main MUSICQ_SET_PLAYBACK 0
end

