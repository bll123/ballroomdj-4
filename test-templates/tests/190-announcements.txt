section 190 Announcements

# no announcement
# test-seq-a has: waltz, tango, foxtrot, quickstep
test 190-10 No-Announce
msg main QUEUE_PLAYLIST 0~test-seq-a
mssleep 100
get player CHK_PLAYER_STATUS
chk prepqueuecount 5
msg main CMD_PLAY
resptimeout 2000
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 4
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Waltz
msg player PLAY_FADE
resptimeout 7000
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 4
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Tango
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 4
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Foxtrot
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 4
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Quickstep
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 4
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Waltz
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 4
end

# with announcement
# test-seq-d has: waltz, tango, foxtrot, quickstep
# test-seq-d has announcements on
# only waltz and tango have announcements
# the player's prep queue will always have the two announcements in it
# announcements should be played for all subsequent songs
test 190-20 With-Playlist-Announce
msg main QUEUE_PLAYLIST 0~test-seq-d
mssleep 300
get player CHK_PLAYER_STATUS
chk prepqueuecount 7
msg main CMD_PLAY
resptimeout 2000
get player CHK_PLAYER_STATUS
wait playstate playing
get player CHK_PLAYER_SONG
chk p-songfn ann-waltz.mp3
mssleep 2000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 6
get player CHK_PLAYER_SONG
chk-not p-songfn ann-waltz.mp3
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Waltz
msg player PLAY_FADE
resptimeout 7000
get player CHK_PLAYER_STATUS
wait playstate playing
get player CHK_PLAYER_SONG
chk p-songfn ann-tango.mp3
mssleep 2000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 6
get player CHK_PLAYER_SONG
chk-not p-songfn ann-tango.mp3
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Tango
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 6
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Foxtrot
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 6
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Quickstep
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate playing
get player CHK_PLAYER_SONG
chk p-songfn ann-waltz.mp3
mssleep 1000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 6
get player CHK_PLAYER_SONG
chk-not p-songfn ann-waltz.mp3
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Waltz
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate playing
get player CHK_PLAYER_SONG
chk p-songfn ann-tango.mp3
mssleep 2000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 6
get player CHK_PLAYER_SONG
chk-not p-songfn ann-tango.mp3
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Tango
end

# with announcement
# test-seq-a has: waltz, tango, foxtrot, quickstep
# test-seq-a has announcements off
# only waltz and tango have announcements
# the player's prep queue will always have the two announcements in it
# announcements should be played for all subsequent songs
test 190-30 With-Global-Announce
msg main CHK_MAIN_SET_PLAYANNOUNCE 1
msg main QUEUE_PLAYLIST 0~test-seq-a
mssleep 100
get player CHK_PLAYER_STATUS
chk prepqueuecount 7
msg main CMD_PLAY
resptimeout 2000
get player CHK_PLAYER_STATUS
wait playstate playing
get player CHK_PLAYER_SONG
chk p-songfn ann-waltz.mp3
mssleep 2000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 6
get player CHK_PLAYER_SONG
chk-not p-songfn ann-waltz.mp3
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Waltz
msg player PLAY_FADE
resptimeout 7000
get player CHK_PLAYER_STATUS
wait playstate playing
get player CHK_PLAYER_SONG
chk p-songfn ann-tango.mp3
mssleep 2000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 6
get player CHK_PLAYER_SONG
chk-not p-songfn ann-tango.mp3
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Tango
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 6
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Foxtrot
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 6
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Quickstep
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate playing
get player CHK_PLAYER_SONG
chk p-songfn ann-waltz.mp3
mssleep 1000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 6
get player CHK_PLAYER_SONG
chk-not p-songfn ann-waltz.mp3
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Waltz
msg player PLAY_FADE
get player CHK_PLAYER_STATUS
wait playstate playing
get player CHK_PLAYER_SONG
chk p-songfn ann-tango.mp3
mssleep 2000
get player CHK_PLAYER_STATUS
chk currvolume defaultvol prepqueuecount 6
get player CHK_PLAYER_SONG
chk-not p-songfn ann-tango.mp3
get main CHK_MAIN_MUSICQ
chk mq0len 91 dance Tango
msg main CHK_MAIN_SET_PLAYANNOUNCE 0
end

