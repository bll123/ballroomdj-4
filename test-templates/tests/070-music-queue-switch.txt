section 70 Music-Queue-Switch-Empty

test 70-10 Playback-Switch-Empty
# MUSICQ_CURRENT == 6
msg main QUEUE_SWITCH_EMPTY 1
msg main MUSICQ_INSERT 6~999~2
msg main CMD_PLAY
resptimeout 2000
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get main CHK_MAIN_MUSICQ
# mq 1 has an empty head pushed
chk mqmanage 0 mqplay 0 mq0len 1 mq1len 1 mq0idx0 2 mq1idx1 -1 dbidx 2
get player CHK_PLAYER_STATUS
chk playstate playing
msg main MUSICQ_SET_MANAGE 1
msg main MUSICQ_INSERT 6~999~3
get main CHK_MAIN_MUSICQ
# note that an empty entry has been pushed on to the head of
# the non-playback queue
chk mqmanage 1 mqplay 0 mq0len 1 mq1len 2 mq0idx0 2 mq1idx1 3
msg main MUSICQ_INSERT 6~999~5
get main CHK_MAIN_MUSICQ
chk mqmanage 1 mqplay 0 mq0len 1 mq1len 3 mq0idx0 2 mq1idx1 3 mq1idx2 5 dbidx 2
get player CHK_PLAYER_STATUS
chk playstate playing
# fade q 0 song
msg player PLAY_FADE
resptimeout 8000
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get main CHK_MAIN_MUSICQ
# should now be playing from q 1
chk mqmanage 1 mqplay 1 mq0len 0 mq1len 2 mq0idx1 -1 mq1idx0 3 mq1idx1 5 dbidx 3
# fade q 1 song
msg player PLAY_FADE
resptimeout 8000
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get main CHK_MAIN_MUSICQ
chk mqmanage 1 mqplay 1 mq0len 0 mq1len 1 mq0idx1 -1 mq1idx0 5 dbidx 5
msg player PLAY_FADE
resptimeout 8000
get player CHK_PLAYER_STATUS
wait playstate stopped
end

test 70-20 Playback-Switch-Switch
# MUSICQ_CURRENT == 6
msg main QUEUE_SWITCH_EMPTY 1
msg main MUSICQ_INSERT 6~999~2
msg main CMD_PLAY
resptimeout 2000
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get main CHK_MAIN_MUSICQ
# mq 1 has an empty head pushed
chk mqmanage 0 mqplay 0 mq0len 1 mq1len 1 mq0idx0 2 mq1idx1 -1 dbidx 2
get player CHK_PLAYER_STATUS
chk playstate playing
msg main MUSICQ_SET_MANAGE 1
msg main MUSICQ_INSERT 6~999~3
get main CHK_MAIN_MUSICQ
# note that an empty entry has been pushed on to the head of
# the non-playback queue
chk mqmanage 1 mqplay 0 mq0len 1 mq1len 2 mq0idx0 2 mq1idx1 3
get player CHK_PLAYER_STATUS
chk playstate playing
# fade q 0 song
msg player PLAY_FADE
resptimeout 8000
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get main CHK_MAIN_MUSICQ
# should now be playing from q 1
chk mqmanage 1 mqplay 1 mq0len 0 mq1len 1 mq0idx1 -1 mq1idx0 3 dbidx 3
# set up another song in q 0
msg main MUSICQ_SET_MANAGE 0
msg main MUSICQ_INSERT 6~999~4
get main CHK_MAIN_MUSICQ
# q 0 has an empty head pushed
chk mqmanage 0 mqplay 1 mq0len 2 mq1len 1 mq0idx1 4 mq1idx0 3 dbidx 3
# fade q 1 song
msg player PLAY_FADE
resptimeout 8000
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get main CHK_MAIN_MUSICQ
chk mqmanage 0 mqplay 0 mq0len 1 mq1len 0 mq0idx0 4 mq1idx1 -1 dbidx 4
msg player PLAY_FADE
resptimeout 8000
get player CHK_PLAYER_STATUS
wait playstate stopped
end

