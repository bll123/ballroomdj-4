section 60 Music-Queue-Dual

test 60-10 Insert-Current
# MUSICQ_CURRENT == 6
msg main MUSICQ_INSERT 6~999~0
get main CHK_MAIN_MUSICQ
# mq 1 has an empty head pushed
chk mqmanage 0 mq0len 1 mq1len 1 mq0idx0 0 mq1idx1 -1
msg main MUSICQ_SET_MANAGE 1
msg main MUSICQ_INSERT 6~999~1
get main CHK_MAIN_MUSICQ
# note that an empty entry has been pushed on to the head of
# the non-playback queue
chk mqmanage 1 mq0len 1 mq1len 2 mq0idx0 0 mq1idx1 1
msg main MUSICQ_SET_MANAGE 0
msg main MUSICQ_INSERT 6~999~2
get main CHK_MAIN_MUSICQ
chk mqmanage 0 mq0len 2 mq1len 2 mq0idx0 0 mq0idx1 2 mq1idx1 1
msg main MUSICQ_SET_MANAGE 1
msg main MUSICQ_INSERT 6~999~3
get main CHK_MAIN_MUSICQ
chk mqmanage 1 mq0len 2 mq1len 3 mq0idx0 0 mq0idx1 2 mq1idx1 1 mq1idx2 3
end

test 60-20 Insert-Specific
get main CHK_MAIN_MUSICQ
msg main MUSICQ_INSERT 0~999~0
get main CHK_MAIN_MUSICQ
# mq 1 has an empty head pushed
chk mqmanage 0 mq0len 1 mq1len 1 mq0idx0 0 mq1idx1 -1
msg main MUSICQ_INSERT 1~999~1
get main CHK_MAIN_MUSICQ
# note that an empty entry has been pushed on to the head of
# the non-playback queue
chk mqmanage 1 mq0len 1 mq1len 2 mq0idx0 0 mq1idx1 1
msg main MUSICQ_INSERT 0~999~2
get main CHK_MAIN_MUSICQ
chk mqmanage 0 mq0len 2 mq1len 2 mq0idx0 0 mq0idx1 2 mq1idx1 1
msg main MUSICQ_INSERT 1~999~3
get main CHK_MAIN_MUSICQ
chk mqmanage 1 mq0len 2 mq1len 3 mq0idx0 0 mq0idx1 2 mq1idx1 1 mq1idx2 3
end

test 60-21 Insert-Specific-Current
# MUSICQ_CURRENT == 6
msg main MUSICQ_INSERT 0~999~0
get main CHK_MAIN_MUSICQ
# mq 1 has an empty head pushed
chk mqmanage 0 mq0len 1 mq1len 1 mq0idx0 0 mq1idx1 -1
msg main MUSICQ_INSERT 6~999~2
get main CHK_MAIN_MUSICQ
chk mqmanage 0 mq0len 2 mq1len 1 mq0idx0 0 mq0idx1 2 mq1idx1 -1
msg main MUSICQ_INSERT 1~999~1
get main CHK_MAIN_MUSICQ
# note that an empty entry has been pushed on to the head of
# the non-playback queue
chk mqmanage 1 mq0len 2 mq1len 2 mq0idx0 0 mq0idx1 2 mq1idx1 1
msg main MUSICQ_INSERT 6~999~3
get main CHK_MAIN_MUSICQ
chk mqmanage 1 mq0len 2 mq1len 3 mq0idx0 0 mq0idx1 2 mq1idx1 1 mq1idx2 3
end

test 60-30 Playback
# MUSICQ_CURRENT == 6
msg main MUSICQ_INSERT 6~999~2
msg main CMD_PLAY
resptimeout 2000
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get main CHK_MAIN_MUSICQ
# mq 1 has an empty head pushed
chk mqmanage 0 mqplay 0 mq0len 1 mq1len 1 mq0idx0 2 mq1idx1 -1 dbidx 2
get player CHK_PLAYER_STATUS
chk playstate playing
msg main MUSICQ_SET_MANAGE 1
msg main MUSICQ_INSERT 6~999~3
get main CHK_MAIN_MUSICQ
# note that an empty entry has been pushed on to the head of
# the non-playback queue
chk mqmanage 1 mqplay 0 mq0len 1 mq1len 2 mq0idx0 2 mq1idx1 3
msg main MUSICQ_SET_MANAGE 0
msg main MUSICQ_INSERT 6~999~4
get main CHK_MAIN_MUSICQ
chk mqmanage 0 mqplay 0 mq0len 2 mq1len 2 mq0idx0 2 mq0idx1 4 mq1idx1 3 dbidx 2
get player CHK_PLAYER_STATUS
chk playstate playing
msg main MUSICQ_SET_MANAGE 1
msg main MUSICQ_INSERT 6~999~5
get main CHK_MAIN_MUSICQ
chk mqmanage 1 mqplay 0 mq0len 2 mq1len 3 mq0idx0 2 mq0idx1 4 mq1idx1 3 mq1idx2 5 dbidx 2
get player CHK_PLAYER_STATUS
chk playstate playing
msg player PLAY_FADE
resptimeout 6500
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 2000
get main CHK_MAIN_MUSICQ
chk mqmanage 1 mqplay 0 mq0len 1 mq1len 3 mq0idx0 4 mq1idx1 3 mq1idx2 5 dbidx 4
end

test 60-40 Select-Playback-Queue
# MUSICQ_CURRENT == 6
msg main MUSICQ_INSERT 6~999~2
msg main CMD_PLAY
resptimeout 2000
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 1000
get main CHK_MAIN_MUSICQ
# mq 1 has an empty head pushed
chk mqmanage 0 mqplay 0 mq0len 1 mq1len 1 mq0idx0 2 mq1idx1 -1 dbidx 2
get player CHK_PLAYER_STATUS
chk playstate playing
msg main MUSICQ_SET_MANAGE 1
msg main MUSICQ_INSERT 6~999~3
get main CHK_MAIN_MUSICQ
# note that an empty entry has been pushed on to the head of
# the non-playback queue
chk mqmanage 1 mqplay 0 mq0len 1 mq1len 2 mq0idx0 2 mq1idx1 3
msg main MUSICQ_SET_MANAGE 0
msg main MUSICQ_INSERT 6~999~4
get main CHK_MAIN_MUSICQ
chk mqmanage 0 mqplay 0 mq0len 2 mq1len 2 mq0idx0 2 mq0idx1 4 mq1idx1 3 dbidx 2
get player CHK_PLAYER_STATUS
chk playstate playing
msg main MUSICQ_SET_MANAGE 1
msg main MUSICQ_INSERT 6~999~5
get main CHK_MAIN_MUSICQ
chk mqmanage 1 mqplay 0 mq0len 2 mq1len 3 mq0idx0 2 mq0idx1 4 mq1idx1 3 mq1idx2 5 dbidx 2
get player CHK_PLAYER_STATUS
chk playstate playing
msg main MUSICQ_SET_PLAYBACK 1
msg player PLAY_FADE
resptimeout 6500
get player CHK_PLAYER_STATUS
wait playstate playing
mssleep 2000
get main CHK_MAIN_MUSICQ
# queue 0 now has the empty head
# queue 1 no longer has the empty head
chk mqmanage 1 mqplay 1 mq0len 2 mq1len 2 mq0idx1 4 mq1idx0 3 mq1idx1 5 dbidx 3
end

